[< back to main](../solve-it.md)
# T1150

**ID:** T1150

**Name:** Recover non-allocated files using residual file metadata

**Description:**

Use metadata that remains in the file system to recover non-allocated files

**Synonyms:**



**Details:**



**Subtechniques:**



**Examples:**



**Output Classes:**

- [https://ontology.unifiedcyberontology.org/uco/core/confidence](https://ontology.unifiedcyberontology.org/uco/core/confidence)
- [https://ontology.unifiedcyberontology.org/uco/observable/File](https://ontology.unifiedcyberontology.org/uco/observable/File)
- [https://ontology.unifiedcyberontology.org/uco/observable/Directory](https://ontology.unifiedcyberontology.org/uco/observable/Directory)
- [https://ontology.unifiedcyberontology.org/uco/observable/allocationStatus](https://ontology.unifiedcyberontology.org/uco/observable/allocationStatus)
- [https://ontology.unifiedcyberontology.org/uco/observable/mftFileID](https://ontology.unifiedcyberontology.org/uco/observable/mftFileID)
- [https://ontology.unifiedcyberontology.org/uco/observable/extInodeID](https://ontology.unifiedcyberontology.org/uco/observable/extInodeID)
- [https://ontology.unifiedcyberontology.org/uco/observable/filePath](https://ontology.unifiedcyberontology.org/uco/observable/filePath)
- [https://ontology.unifiedcyberontology.org/uco/observable/fileName](https://ontology.unifiedcyberontology.org/uco/observable/fileName)
- [https://ontology.unifiedcyberontology.org/uco/observable/modifiedTime](https://ontology.unifiedcyberontology.org/uco/observable/modifiedTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/accessedTime](https://ontology.unifiedcyberontology.org/uco/observable/accessedTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/creationTime](https://ontology.unifiedcyberontology.org/uco/observable/creationTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/metadataChangeTime](https://ontology.unifiedcyberontology.org/uco/observable/metadataChangeTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/mftRecordChangeTime](https://ontology.unifiedcyberontology.org/uco/observable/mftRecordChangeTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameModifiedTime](https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameModifiedTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameAccessedTime](https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameAccessedTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameCreatedTime](https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameCreatedTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameRecordChangeTime](https://ontology.unifiedcyberontology.org/uco/observable/mftFileNameRecordChangeTime)
- [https://ontology.unifiedcyberontology.org/uco/observable/ntfsOwnerID](https://ontology.unifiedcyberontology.org/uco/observable/ntfsOwnerID)
- [https://ontology.unifiedcyberontology.org/uco/observable/ntfsOwnerSID](https://ontology.unifiedcyberontology.org/uco/observable/ntfsOwnerSID)
- [https://ontology.unifiedcyberontology.org/uco/observable/ownerSID](https://ontology.unifiedcyberontology.org/uco/observable/ownerSID)


**Potential weaknesses and potential mitigations:**

- [W1134](W1134.md): Recovered (non-allocated) file content has been overwritten by the content of a newer, but also non-allocated file (which has residual file system information) but this is not detected  _(INAC-AS, MISINT)_
    - M1079: Analyse file content to detect incompatibility between the content and the recovered file system metadata 
    - M1080: Use a hashset of known files to detect that recovered content does not match the expected file content 
    - M1081: Check if recovered content matches with size in metadata e.g. file footer at expected location. 
    - M1082: Analyse file system to find any duplicate references to blocks that are referenced by the non-allocated file 
    - M1083: Analyse content for embedded timestamps to find that content is a newer file than indicated by metadata (beware of file tunneling) 
- [W1135](W1135.md): Recovered (non-allocated) file content has been overwritten by the content of a newer live file but this is not detected  _(INAC-AS, MISINT)_
    - M1079: Analyse file content to detect incompatibility between the content and the recovered file system metadata 
    - M1080: Use a hashset of known files to detect that recovered content does not match the expected file content 
    - M1081: Check if recovered content matches with size in metadata e.g. file footer at expected location. 
    - M1082: Analyse file system to find any duplicate references to blocks that are referenced by the non-allocated file 
    - M1083: Analyse content for embedded timestamps to find that content is a newer file than indicated by metadata (beware of file tunneling) 
- [W1253](W1253.md): Recovered (non-allocated) file content has been overwritten by the content of a newer, but also non-allocated file which does not have any residual file system information _(INAC-AS, MISINT)_
    - M1079: Analyse file content to detect incompatibility between the content and the recovered file system metadata 
    - M1080: Use a hashset of known files to detect that recovered content does not match the expected file content 
    - M1081: Check if recovered content matches with size in metadata e.g. file footer at expected location. 
    - M1083: Analyse content for embedded timestamps to find that content is a newer file than indicated by metadata (beware of file tunneling) 
- [W1254](W1254.md): Recovered (non-allocated) file content is incorrect due to an incorrect assumption that the file was contiguous e.g. some residual file metadata exists, but not the full reassembly information _(INAC-EX)_
    - M1196: Check if file being recovered is smaller than a block 
    - M1197: Check if file being recovered is resident (applicable on some file systems) 
    - M1079: Analyse file content to detect incompatibility between the content and the recovered file system metadata 
    - M1080: Use a hashset of known files to detect that recovered content does not match the expected file content 
    - M1081: Check if recovered content matches with size in metadata e.g. file footer at expected location. 
- [W1255](W1255.md): Recovered file content is incorrect due to incorrect parsing of file size information that records allocated but unwritten sectors (e.g. Valid Data Length (VDL) _(INAC-EX)_
    - M1198: Check if file system and operating system make use of an 'allocated but unwritten' value e.g. VDL. 
    - M1199: Check all relevant file size metadata values when recovering file content 
    - M1200: Ensure that inconsistencies between allocated data size and data written size are clearly flagged. 
    - M1079: Analyse file content to detect incompatibility between the content and the recovered file system metadata 
    - M1080: Use a hashset of known files to detect that recovered content does not match the expected file content 
    - M1081: Check if recovered content matches with size in metadata e.g. file footer at expected location. 
- [W1256](W1256.md): Incorrect attribution of metadata to file content that was the result of 'file tunnelling' _(INAC-AS, MISINT)_
    - M1079: Analyse file content to detect incompatibility between the content and the recovered file system metadata 
    - M1080: Use a hashset of known files to detect that recovered content does not match the expected file content 
    - M1081: Check if recovered content matches with size in metadata e.g. file footer at expected location. 


**References:**

- Casey, E., Nelson, A. and Hyde, J., 2019. Standardization of file recovery classification and authentication. Digital Investigation, 31, p.100873.
- Carrier, B., 2005. File system forensic analysis. Addison-Wesley Professional.




---

*Markdown generated: 2026-02-05 01:58:17*
